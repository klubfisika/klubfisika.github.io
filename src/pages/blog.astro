---
import Layout from "@layouts/Layout.astro";
import BlogHeroSection from "@blog/BlogHeroSection.astro";
import FeaturedArticle from "@blog/FeaturedArticle.astro";
import ArticleGrid from "@blog/ArticleGrid.astro";
import SearchCard from "@blog/SearchCard.astro";
import CategoriesCard from "@blog/CategoriesCard.astro";
import TagsCard from "@blog/TagsCard.astro";
import RecentArticlesCard from "@blog/RecentArticlesCard.astro";
import StatsCard from "@blog/StatsCard.astro";
import NewsletterCard from "@blog/NewsletterCard.astro";
import BrutalSection from "@ui/BrutalSection.astro";
import SectionHeaderWithHash from "@ui/SectionHeaderWithHash.astro";
import { getAllPosts, getRecentPosts, getPopularTags, getBlogStats } from "@data/blogPosts";
import type { BlogPost, PopularTag, BlogStats } from "@types/blog";

// Data fetching with type safety
const allPosts: BlogPost[] = getAllPosts();
const recentPosts = getRecentPosts(3);
const popularTags: PopularTag[] = getPopularTags();
const blogStats: BlogStats = getBlogStats();
const featuredPost: BlogPost = allPosts[0];
const remainingPosts: BlogPost[] = allPosts.slice(1);
---

<Layout 
    title="Blog & Artikel - KF13 Klub Fisika Indonesia" 
    description="Artikel fisika, tutorial eksperimen, tips belajar, dan berita terbaru dari komunitas KF13 Klub Fisika Indonesia"
>
    <BlogHeroSection />

    <BrutalSection background="white" padding="xl">
        <div class="max-w-7xl mx-auto">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                <!-- Sidebar -->
                <aside class="lg:col-span-1 space-y-6" role="complementary" aria-label="Sidebar navigasi blog">
                    <SearchCard />
                    <CategoriesCard />
                    <TagsCard tags={popularTags} />
                    <RecentArticlesCard articles={recentPosts} />
                    <NewsletterCard />
                    <StatsCard stats={blogStats} />
                </aside>

                <!-- Main Content -->
                <main class="lg:col-span-3">
                    <SectionHeaderWithHash 
                        id="articles"
                        title="â­ ARTIKEL TERBARU" 
                        subtitle="Konten terpopuler dan terbaru dari komunitas"
                        class="mb-8"
                    />
            
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16">
                        <FeaturedArticle post={featuredPost} />
                    </div>

                    <ArticleGrid articles={remainingPosts} />
                </main>
            </div>
        </div>
    </BrutalSection>
</Layout>

<script>
import '@scripts/blogFilterManager.ts';
</script>
