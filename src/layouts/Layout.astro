---
import "@/styles/main.css";
import BaseHead from "@components/BaseHead.astro";
import Navigation from "@components/Navigation.astro";
import Footer from "@sections/Footer.astro";
import FloatingActions from "@ui/FloatingActions.astro";
import BackToTop from "@ui/BackToTop.astro";
import TestingChecklist from "@ui/TestingChecklist.astro";
import ResponsiveTest from "@ui/ResponsiveTest.astro";

export interface Props {
    title: string;
    description: string;
    backToTopThreshold?: number;
}

const { title, description, backToTopThreshold = 300 } = Astro.props;

// Detect current page for scroll offset customization
const pathname = Astro.url.pathname;
let scrollOffset = 'medium'; // default

if (pathname.includes('/about')) {
    scrollOffset = 'small';
} else if (pathname.includes('/events')) {
    scrollOffset = 'xlarge';
} else if (pathname.includes('/blog')) {
    scrollOffset = 'medium';
} else if (pathname.includes('/contact')) {
    scrollOffset = 'medium';
} else if (pathname.includes('/partnership')) {
    scrollOffset = 'medium';
} else if (pathname.includes('/research')) {
    scrollOffset = 'medium';
} else {
    scrollOffset = 'medium'; // homepage
}
---

<!doctype html>
<html lang="id" class="scroll-smooth">
    <head>
        <BaseHead title={title} description={description} />
        <slot name="head" />
    </head>
    <body class="font-sans bg-surface dark:bg-surface-dark text-dark dark:text-light transition-colors" data-scroll-offset={scrollOffset}>
        <!-- Skip Links for Keyboard Navigation -->
        <div class="skip-links">
            <a href="#main-content" class="skip-link">Skip to main content</a>
            <a href="#navigation" class="skip-link">Skip to navigation</a>
        </div>

        <style>
            .skip-links {
                position: absolute;
                top: -100px;
                left: 0;
                z-index: 1000;
            }
            
            .skip-link {
                position: absolute;
                top: -100px;
                left: 8px;
                background: #1d4ed8;
                color: white;
                padding: 8px 16px;
                text-decoration: none;
                font-weight: bold;
                border-radius: 4px;
                border: 2px solid #1a1a1a;
                box-shadow: 4px 4px 0 #1a1a1a;
                transition: top 0.3s;
            }
            
            .skip-link:focus {
                top: 8px;
            }
            
            .skip-link:nth-child(2) {
                left: 200px;
            }
        </style>
        
        <Navigation />
        <FloatingActions />
        <BackToTop 
            threshold={backToTopThreshold} 
            showReadingTime={Astro.url.pathname.startsWith('/blog/') && !Astro.url.pathname.endsWith('/blog')}
            articleSelector=".article-content"
        />
        
        <!-- Development Only Components -->
        {import.meta.env.DEV && (
            <>
                <TestingChecklist />
                <ResponsiveTest />
            </>
        )}
        
        <main id="main-content" class="pt-20">
            <slot />
        </main>
        
        <Footer />
    </body>
</html>
